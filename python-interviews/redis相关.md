## redis限流手段
- 计数器（时间间隔内操作数zcard）
- 漏斗法（redis-cell）
- 令牌桶（时间内取令牌，不够则返回，够则发放）

## 限流、降级、熔断
- 限流就是限制单位时间内请求数量
- 降级就是为了解决资源不足和访问量增加的矛盾
- 熔断就是内部出现问题时候, 上游服务进行熔断。

## redis有哪些数据结构
- string 
- list
- set 
- sorted_set
- hash 

## redis分布式锁
- setnx 抢占锁资源, expire来强制释放
- 为了防止crash, setnx和expire做成原子性操作。

## 查看redis的相同前缀key
- keys * （缺点是会造成线上服务停顿）
- scan 但会有一定重复概率, 让客户端去重即可。

## 如果大量key同时过期, 
- 随机数分散过期, 避免雪崩卡顿

## redis持久化
- bgsave做全量持久化, aof做增量持久化。
- 优先使用aof回复内存状态, 如果没有的话就用rdb文件进行回复。

## aof文件过大恢复时间过长怎么办？
- redis会定期压缩aof日志, Redis4.0之后有了混合持久化的功能, 将bgsave的全量和aof的增量做了融合处理。

## aof回复过程掉电怎么办？
- 取决于aof日志同步属性的配置, 如果不要求性能, 那就逐条命令同步, 高性能下则定时同步。

## bgsave的原理是什么？
- fork一个子进程, copy on write。父子进程共享数据段。

## Pipeline有什么好处, 为什么要用pipeline？
- 减少io操作。

## redis的同步机制
- 主从同步, 主节点做一次bgsave, 并同时将后续修改记录写入内存buffer
- 待完成后将rdb文件全量同步到子节点, 完成镜像同步后再加载写脏了的内存数据。

## redis集群的原理?
- 高可用和高扩展。

